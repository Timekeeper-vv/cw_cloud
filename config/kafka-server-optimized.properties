# Kafka优化配置 - 针对高吞吐量场景 (2M+ 样本/秒)
# 适用于8核30GB服务器

############################# Server Basics #############################
broker.id=0
listeners=PLAINTEXT://localhost:9092
advertised.listeners=PLAINTEXT://localhost:9092

############################# Log Basics #############################
log.dirs=/var/kafka-logs
num.partitions=3
default.replication.factor=1

############################# 高吞吐量优化 #############################
# 网络线程 - 增加到8个（匹配CPU核心数）
num.network.threads=8

# IO线程 - 增加到16个（2倍CPU核心数）
num.io.threads=16

# 请求队列大小
queued.max.requests=1000

############################# Socket优化 #############################
# 发送缓冲区 - 1MB
socket.send.buffer.bytes=1048576

# 接收缓冲区 - 1MB  
socket.receive.buffer.bytes=1048576

# 最大请求大小 - 100MB
socket.request.max.bytes=104857600

############################# 日志优化 #############################
# 日志段大小 - 1GB
log.segment.bytes=1073741824

# 日志保留时间 - 24小时（减少磁盘占用）
log.retention.hours=24

# 日志清理检查间隔 - 5分钟
log.retention.check.interval.ms=300000

# 禁用日志压缩（减少CPU开销）
log.cleaner.enable=false
log.cleanup.policy=delete

# 日志刷新策略 - 异步刷新提升性能
log.flush.interval.messages=50000
log.flush.interval.ms=10000

############################# 复制优化 #############################
# 副本拉取线程
num.replica.fetchers=4

# 副本拉取最大字节
replica.fetch.max.bytes=10485760

############################# Zookeeper #############################
zookeeper.connect=localhost:2181
zookeeper.connection.timeout.ms=18000

############################# 生产者优化 #############################
# 消息最大大小 - 50MB
message.max.bytes=52428800

# 副本最大消息大小
replica.fetch.max.bytes=52428800

############################# 其他优化 #############################
# 组初始重平衡延迟
group.initial.rebalance.delay.ms=0

# 事务配置（单节点）
offsets.topic.replication.factor=1
transaction.state.log.replication.factor=1
transaction.state.log.min.isr=1

# 自动创建主题
auto.create.topics.enable=true
