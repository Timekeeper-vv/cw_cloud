# 启动脚本使用说明

## 📋 现有脚本概览

| 脚本文件 | 启动服务 | 适用场景 | 推荐度 |
|---------|---------|---------|--------|
| `quick-start.sh` | Gateway + System + Infra + 前端 | 基础功能，不包含IoT和告警 | ⭐⭐⭐ |
| `start-with-iot.sh` | 所有服务 + IoT模块 | IoT功能未编译时会失败 | ⭐⭐ |
| `restart-system.sh` | 仅重启System服务 | 修改了System模块后 | ⭐⭐⭐⭐ |
| `stop-all.sh` | 停止所有服务 | 清理服务 | ⭐⭐⭐⭐⭐ |

---

## 🎯 推荐使用方案

### 方案一：只使用基础服务（推荐 ⭐⭐⭐⭐⭐）

**启动命令**：
```bash
cd /home/darkaling/yudao-cloud
./quick-start.sh
```

**包含服务**：
- ✅ MySQL + Redis + Nacos (Docker容器)
- ✅ Gateway（网关服务，48080端口）
- ✅ System（系统服务，48081端口） - **包含告警Mock接口**
- ✅ Infra（基础设施服务，48082端口）
- ✅ 前端开发服务器（3000端口）

**优点**：
- ✅ 启动快速（1-2分钟）
- ✅ 稳定可靠
- ✅ 包含所有基础功能
- ✅ **包含真实信号读取和告警Mock接口**（因为在System模块中）

**适用于**：
- 日常开发和测试
- 前端功能演示
- 信号读取和显示

---

## 🚀 标准启动流程（推荐）

### 完整启动步骤

```bash
# 1. 进入项目目录
cd /home/darkaling/yudao-cloud

# 2. 停止旧服务（如果有）
./quick-stop.sh

# 3. 启动所有基础服务
./quick-start.sh

# 4. 等待2-3分钟，让服务完全启动

# 5. 查看服务状态
ps aux | grep java | grep -E "(gateway|system|infra)"
```

### 验证服务

```bash
# 检查Gateway（网关）
curl http://localhost:48080/actuator/health

# 检查System（系统服务）
curl http://localhost:48081/actuator/health

# 检查测试接口
curl http://localhost:48080/admin-api/test/signal/health
curl http://localhost:48080/admin-api/test/real-signal/info
```

### 前端访问

浏览器访问：`http://localhost:3000`

---

## 🔄 特殊场景使用脚本

### 场景1：修改了System模块代码

**使用**：`./restart-system.sh`

```bash
cd /home/darkaling/yudao-cloud
./restart-system.sh
```

**作用**：
- 停止System服务
- 重新编译System模块
- 启动System服务

**适用于**：
- 添加了新的Controller
- 修改了Service层代码
- 更新了Mapper

### 场景2：完全清理重启

**使用**：`./stop-all.sh` + `./quick-start.sh`

```bash
cd /home/darkaling/yudao-cloud

# 1. 停止所有服务
./stop-all.sh

# 2. 等待5秒
sleep 5

# 3. 重新启动
./quick-start.sh
```

---

## 📝 我的建议

### 🌟 日常开发推荐使用

```bash
# 每天开始工作时
cd /home/darkaling/yudao-cloud
./quick-start.sh

# 每天结束工作时
./stop-all.sh
```

**原因**：
1. ✅ `quick-start.sh` 包含了所有必要的服务
2. ✅ System服务中已经包含告警Mock接口和信号读取接口
3. ✅ 不需要IoT模块也能正常工作
4. ✅ 启动快速、稳定

### 如果修改了System模块

```bash
# 只需重启System服务即可
./restart-system.sh
```

---

## 🗂️ 脚本文件说明

### quick-start.sh ⭐⭐⭐⭐⭐
**用途**：日常启动  
**包含**：Gateway + System + Infra + 前端  
**时间**：2-3分钟  
**推荐**：✅ 日常使用

### quick-stop.sh ⭐⭐⭐⭐⭐
**用途**：停止基础服务  
**包含**：Gateway + System + Infra  
**时间**：5秒  
**推荐**：✅ 日常使用

### stop-all.sh ⭐⭐⭐⭐⭐
**用途**：停止所有服务（包括IoT）  
**包含**：所有Java进程  
**时间**：5秒  
**推荐**：✅ 完全清理时使用

### restart-system.sh ⭐⭐⭐⭐
**用途**：快速重启System  
**包含**：仅System服务  
**时间**：1-2分钟  
**推荐**：✅ 修改System代码后使用

### start-with-iot.sh ⭐⭐
**用途**：启动包括IoT的所有服务  
**问题**：IoT模块编译可能失败  
**推荐**：❌ 暂不推荐（IoT模块配置问题）

---

## ✅ 最佳实践

### 日常启动（推荐）

```bash
#!/bin/bash
# 我的日常启动流程

cd /home/darkaling/yudao-cloud

# 1. 启动基础服务
./quick-start.sh

# 2. 等待启动完成
echo "等待服务启动..."
sleep 120  # 等待2分钟

# 3. 验证服务
echo "验证服务状态..."
curl -s http://localhost:48080/admin-api/test/signal/health | grep "UP" && echo "✅ System服务正常"

# 4. 打开浏览器
echo "访问: http://localhost:3000"
```

### 日常停止

```bash
cd /home/darkaling/yudao-cloud
./stop-all.sh
```

---

## 🎯 总结

**您应该使用**: **`quick-start.sh`**

**原因**：
1. ✅ 包含所有必要功能
2. ✅ 告警接口已在System模块中实现
3. ✅ 信号读取接口也在System模块中
4. ✅ 稳定可靠，启动快速
5. ✅ 不依赖问题较多的IoT模块编译

**何时需要重启**：
- 只有修改了System模块代码时，才需要执行 `./restart-system.sh`
- 其他情况直接用 `./quick-start.sh` 即可

---

**更新时间**: 2025-10-20  
**推荐脚本**: `quick-start.sh` ⭐⭐⭐⭐⭐

