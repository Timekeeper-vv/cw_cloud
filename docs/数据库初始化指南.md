# ğŸ“Š æ•°æ®åº“åˆå§‹åŒ–æŒ‡å—

## ğŸ”§ **æ­¥éª¤1: è¿æ¥MySQLæ•°æ®åº“**

### **æ–¹æ³•1: ä½¿ç”¨å‘½ä»¤è¡Œ**
```bash
# è¿æ¥æ•°æ®åº“ï¼ˆè¯·æ ¹æ®æ‚¨çš„å®é™…å¯†ç ä¿®æ”¹ï¼‰
mysql -u root -p

# è¾“å…¥å¯†ç åï¼Œé€‰æ‹©æ•°æ®åº“
USE ruoyi-vue-pro;
```

### **æ–¹æ³•2: ä½¿ç”¨å›¾å½¢åŒ–å·¥å…·**
- **Navicat / MySQL Workbench / phpMyAdmin**
- è¿æ¥ä¿¡æ¯ï¼š
  - ä¸»æœº: localhost
  - ç«¯å£: 3306  
  - ç”¨æˆ·: root
  - å¯†ç : [æ‚¨çš„MySQLå¯†ç ]
  - æ•°æ®åº“: ruoyi-vue-pro

---

## ğŸ“‹ **æ­¥éª¤2: æ‰§è¡Œå»ºè¡¨è„šæœ¬**

### **é€‰é¡¹A: ç›´æ¥æ‰§è¡ŒSQLæ–‡ä»¶**
```bash
# åœ¨MySQLå‘½ä»¤è¡Œä¸­æ‰§è¡Œ
SOURCE e:/Code/CW_Cloud/create-filter-tables.sql;
```

### **é€‰é¡¹B: å¤åˆ¶ç²˜è´´æ‰§è¡Œ**
```sql
-- 1. æ»¤æ³¢ç»“æœè®°å½•è¡¨
CREATE TABLE IF NOT EXISTS `filter_result_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `device_id` varchar(64) NOT NULL COMMENT 'è®¾å¤‡ID',
  `device_name` varchar(128) DEFAULT NULL COMMENT 'è®¾å¤‡åç§°',
  `session_id` varchar(64) DEFAULT NULL COMMENT 'ä¼šè¯ID',
  
  -- ä¿¡å·æ•°æ®
  `original_samples` json DEFAULT NULL COMMENT 'åŸå§‹ä¿¡å·æ•°æ®(JSONæ•°ç»„)',
  `filtered_samples` json DEFAULT NULL COMMENT 'æ»¤æ³¢åæ•°æ®(JSONæ•°ç»„)',
  `sample_rate` int DEFAULT 1000000 COMMENT 'é‡‡æ ·ç‡(Hz)',
  `sample_count` int DEFAULT 0 COMMENT 'é‡‡æ ·ç‚¹æ•°',
  
  -- æ»¤æ³¢å‚æ•°
  `filter_type` varchar(32) DEFAULT 'LMS' COMMENT 'æ»¤æ³¢å™¨ç±»å‹(LMS/NLMS)',
  `filter_order` int DEFAULT 32 COMMENT 'æ»¤æ³¢å™¨é˜¶æ•°',
  `learning_rate` decimal(10,6) DEFAULT 0.010000 COMMENT 'å­¦ä¹ ç‡',
  `convergence_factor` decimal(10,6) DEFAULT NULL COMMENT 'æ”¶æ•›å› å­',
  
  -- æ€§èƒ½æŒ‡æ ‡
  `snr_improvement` decimal(10,4) DEFAULT NULL COMMENT 'SNRæ”¹å–„å€¼(dB)',
  `mse_error` decimal(15,8) DEFAULT NULL COMMENT 'å‡æ–¹è¯¯å·®',
  `processing_time` int DEFAULT NULL COMMENT 'å¤„ç†æ—¶é—´(ms)',
  
  -- ç»Ÿè®¡ä¿¡æ¯
  `original_rms` decimal(15,8) DEFAULT NULL COMMENT 'åŸå§‹ä¿¡å·RMS',
  `filtered_rms` decimal(15,8) DEFAULT NULL COMMENT 'æ»¤æ³¢ä¿¡å·RMS',
  `noise_reduction` decimal(10,4) DEFAULT NULL COMMENT 'å™ªå£°æŠ‘åˆ¶ç‡(%)',
  
  -- ç³»ç»Ÿå­—æ®µ
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT 'system' COMMENT 'åˆ›å»ºè€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  
  PRIMARY KEY (`id`),
  KEY `idx_device_create_time` (`device_id`,`create_time`),
  KEY `idx_session_id` (`session_id`),
  KEY `idx_filter_type` (`filter_type`),
  KEY `idx_create_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æ»¤æ³¢ç»“æœè®°å½•è¡¨';

-- 2. å¼‚å¸¸æ£€æµ‹è®°å½•è¡¨
CREATE TABLE IF NOT EXISTS `anomaly_detection_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `device_id` varchar(64) NOT NULL COMMENT 'è®¾å¤‡ID',
  `device_name` varchar(128) DEFAULT NULL COMMENT 'è®¾å¤‡åç§°',
  `filter_record_id` bigint DEFAULT NULL COMMENT 'å…³è”çš„æ»¤æ³¢è®°å½•ID',
  
  -- å¼‚å¸¸ä¿¡æ¯
  `anomaly_type` varchar(32) NOT NULL COMMENT 'å¼‚å¸¸ç±»å‹(FREQUENCY/AMPLITUDE/PATTERN)',
  `anomaly_score` decimal(10,6) NOT NULL COMMENT 'å¼‚å¸¸åˆ†æ•°(0-1)',
  `confidence_level` decimal(10,4) DEFAULT NULL COMMENT 'ç½®ä¿¡åº¦(%)',
  
  -- å‘Šè­¦çº§åˆ«
  `alert_level` varchar(16) NOT NULL DEFAULT 'INFO' COMMENT 'å‘Šè­¦çº§åˆ«(INFO/WARN/ERROR/CRITICAL)',
  `threshold_value` decimal(15,8) DEFAULT NULL COMMENT 'é˜ˆå€¼',
  `detected_value` decimal(15,8) DEFAULT NULL COMMENT 'æ£€æµ‹å€¼',
  
  -- è¯¦ç»†ä¿¡æ¯
  `detection_algorithm` varchar(64) DEFAULT NULL COMMENT 'æ£€æµ‹ç®—æ³•',
  `feature_vector` json DEFAULT NULL COMMENT 'ç‰¹å¾å‘é‡(JSON)',
  `context_data` json DEFAULT NULL COMMENT 'ä¸Šä¸‹æ–‡æ•°æ®(JSON)',
  `description` text DEFAULT NULL COMMENT 'å¼‚å¸¸æè¿°',
  
  -- å¤„ç†çŠ¶æ€
  `status` varchar(16) DEFAULT 'PENDING' COMMENT 'å¤„ç†çŠ¶æ€(PENDING/CONFIRMED/IGNORED/RESOLVED)',
  `handled_by` varchar(64) DEFAULT NULL COMMENT 'å¤„ç†äºº',
  `handle_time` datetime DEFAULT NULL COMMENT 'å¤„ç†æ—¶é—´',
  `handle_note` text DEFAULT NULL COMMENT 'å¤„ç†å¤‡æ³¨',
  
  -- ç³»ç»Ÿå­—æ®µ  
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT 'system' COMMENT 'åˆ›å»ºè€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  
  PRIMARY KEY (`id`),
  KEY `idx_device_create_time` (`device_id`,`create_time`),
  KEY `idx_anomaly_type` (`anomaly_type`),
  KEY `idx_alert_level` (`alert_level`),
  KEY `idx_status` (`status`),
  KEY `idx_filter_record` (`filter_record_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='å¼‚å¸¸æ£€æµ‹è®°å½•è¡¨';

-- 3. è®¾å¤‡å®æ—¶çŠ¶æ€è¡¨
CREATE TABLE IF NOT EXISTS `device_realtime_status` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `device_id` varchar(64) NOT NULL COMMENT 'è®¾å¤‡ID',
  `device_name` varchar(128) DEFAULT NULL COMMENT 'è®¾å¤‡åç§°',
  
  -- è¿æ¥çŠ¶æ€
  `connection_status` varchar(16) DEFAULT 'OFFLINE' COMMENT 'è¿æ¥çŠ¶æ€(ONLINE/OFFLINE/ERROR)',
  `last_heartbeat` datetime DEFAULT NULL COMMENT 'æœ€åå¿ƒè·³æ—¶é—´',
  `session_start_time` datetime DEFAULT NULL COMMENT 'ä¼šè¯å¼€å§‹æ—¶é—´',
  
  -- æ•°æ®ç»Ÿè®¡
  `total_packets` bigint DEFAULT 0 COMMENT 'æ€»æ•°æ®åŒ…æ•°',
  `packets_per_second` decimal(10,2) DEFAULT 0.00 COMMENT 'æ¯ç§’æ•°æ®åŒ…æ•°',
  `data_quality_score` decimal(5,2) DEFAULT 100.00 COMMENT 'æ•°æ®è´¨é‡åˆ†æ•°',
  
  -- æ€§èƒ½æŒ‡æ ‡
  `avg_processing_time` decimal(10,4) DEFAULT NULL COMMENT 'å¹³å‡å¤„ç†æ—¶é—´(ms)',
  `current_snr` decimal(10,4) DEFAULT NULL COMMENT 'å½“å‰SNR(dB)',
  `error_rate` decimal(8,4) DEFAULT 0.0000 COMMENT 'é”™è¯¯ç‡(%)',
  
  -- å‘Šè­¦ç»Ÿè®¡
  `total_alerts` int DEFAULT 0 COMMENT 'æ€»å‘Šè­¦æ•°',
  `critical_alerts` int DEFAULT 0 COMMENT 'ä¸¥é‡å‘Šè­¦æ•°',
  `last_alert_time` datetime DEFAULT NULL COMMENT 'æœ€åå‘Šè­¦æ—¶é—´',
  
  -- ç³»ç»Ÿå­—æ®µ
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_device_id` (`device_id`),
  KEY `idx_connection_status` (`connection_status`),
  KEY `idx_last_heartbeat` (`last_heartbeat`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è®¾å¤‡å®æ—¶çŠ¶æ€è¡¨';
```

---

## âœ… **æ­¥éª¤3: éªŒè¯è¡¨åˆ›å»º**

```sql
-- æ£€æŸ¥è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ
SHOW TABLES LIKE '%filter%';
SHOW TABLES LIKE '%anomaly%';
SHOW TABLES LIKE '%device_realtime%';

-- æŸ¥çœ‹è¡¨ç»“æ„
DESC filter_result_record;
DESC anomaly_detection_record; 
DESC device_realtime_status;
```

---

## ğŸ¯ **é¢„æœŸç»“æœ**

æ‰§è¡ŒæˆåŠŸåï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ï¼š
```
+----------------------------+
| Tables_in_ruoyi-vue-pro    |
+----------------------------+
| filter_result_record       |
| anomaly_detection_record   |
| device_realtime_status     |
+----------------------------+
```

**å®Œæˆåè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘å°†ç»§ç»­æŒ‡å¯¼ä¸‹ä¸€æ­¥çš„ä¾èµ–å®‰è£…ï¼** ğŸš€
