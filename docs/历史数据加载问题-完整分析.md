# ğŸ” å†å²æ•°æ®åŠ è½½é—®é¢˜ - å®Œæ•´åˆ†æä¸è§£å†³

## ğŸ“‹ é—®é¢˜æè¿°

**ç—‡çŠ¶ï¼š** ç‚¹å‡»"åŠ è½½æ–‡ä»¶"åæç¤º"åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥TDMS APIæ˜¯å¦å¯åŠ¨"

**ç”¨æˆ·ç–‘é—®ï¼š**
1. ä¸¤ä¸ªæ–¹å¼ï¼ˆå®æ—¶/å†å²ï¼‰åç«¯å’Œè¯»å–æ˜¾ç¤ºæ–¹æ³•æ˜¯ä¸æ˜¯ä¸ä¸€æ ·ï¼Ÿ
2. å¦‚æœæ˜¯çš„ï¼Œå¯ä¸å¯ä»¥ç»Ÿä¸€ï¼Ÿ

---

## ğŸ” é—®é¢˜æ ¹æºåˆ†æ

### é—®é¢˜1ï¼šTDMS APIç¡®å®åœ¨è¿è¡Œ

```bash
# æ£€æŸ¥ç»“æœ
netstat -ano | findstr ":3002"
TCP    0.0.0.0:3002    LISTENING   50220  âœ…
```

### é—®é¢˜2ï¼šPythonè„šæœ¬èƒ½æ‰§è¡Œï¼Œä½†è¿”å›è´Ÿæ•°

```bash
python tdms-folder-analyzer.py signal-1 100000 6500 6

è¾“å‡ºï¼š
{
  "mseImprovement": -3826.93,   â† è´Ÿæ•°ï¼æ»¤æ³¢å¤±è´¥
  "correlation": -0.9861,        â† è´Ÿæ•°ï¼ä¿¡å·åç›¸
  "mseBefore": 0.049946,
  "mseAfter": 1.961345           â† æ¯”æ»¤æ³¢å‰æ›´å·®ï¼
}
```

**åŸå› ï¼š** æˆªæ­¢é¢‘ç‡6500Hzå¯¹äº5000Hzä¿¡å·å¤ªé«˜ï¼Œå¯¼è‡´ï¼š
- å™ªå£°æ²¡è¢«æ»¤é™¤
- ç›¸ä½å»¶è¿Ÿä¸¥é‡
- ä¿¡å·å®Œå…¨å¤±çœŸ

---

## âš–ï¸ ä¸¤ç§æ–¹å¼å¯¹æ¯”åˆ†æ

### æ–¹å¼1ï¼šå®æ—¶æ•°æ®ï¼ˆWebSocketï¼‰

#### æ•°æ®æµç¨‹
```
Backend.jar (Java)
    â†“
å®æ—¶ç”Ÿæˆä¿¡å· + LMSæ»¤æ³¢
    â†“
WebSocket Bridge (Node.js)
    â†“
å‰ç«¯ (RealtimeMonitor.vue)
```

#### æ•°æ®æ ¼å¼
```javascript
{
  type: 'signal-data',
  deviceId: 'DEVICE_001',
  originalSamples: [...],      // 500ä¸ªç‚¹
  filteredSamples: [...],      // å·²æ»¤æ³¢
  currentError: 0.0152,
  anomalies: [...],
  statistics: {
    avgResidual: 0.002
  }
}
```

**ç‰¹ç‚¹ï¼š**
- âœ… æ•°æ®å·²ç»æ»¤æ³¢å¥½
- âœ… æ ¼å¼ç®€å•
- âœ… å®æ—¶æ¨é€

---

### æ–¹å¼2ï¼šå†å²æ–‡ä»¶ï¼ˆTDMSï¼‰

#### æ•°æ®æµç¨‹
```
å‰ç«¯è¯·æ±‚
    â†“
TDMS API Server (Node.js)
    â†“
Pythonè„šæœ¬ (tdms-folder-analyzer.py)
    â†“
è¯»å–TDMSæ–‡ä»¶ + Butterworthæ»¤æ³¢
    â†“
è¿”å›JSON
    â†“
å‰ç«¯ (RealtimeMonitor.vue)
```

#### æ•°æ®æ ¼å¼ï¼ˆåŸå§‹ï¼‰
```javascript
{
  signals: {
    time: [...],           // 2000ä¸ªç‚¹
    sine: [...],          // åŸå§‹å¹²å‡€ä¿¡å·
    noisy: [...],         // åŠ å™ªä¿¡å·
    filtered: [...]       // æ»¤æ³¢åä¿¡å·
  },
  metrics: {
    mseImprovement: 85.3,
    mseBefore: 0.049946,
    mseAfter: 0.007342,
    correlationBefore: 0.9535,
    correlation: 0.9823
  },
  parameters: {
    folder: 'signal-1',
    sampleRate: 100000,
    totalSamples: 200000
  }
}
```

**ç‰¹ç‚¹ï¼š**
- âŒ æ•°æ®ç»“æ„ä¸å®æ—¶ä¸åŒ
- âŒ éœ€è¦æ‰‹åŠ¨è½¬æ¢
- âŒ æ»¤æ³¢å‚æ•°éœ€è¦ç²¾ç¡®è®¾ç½®

---

## ğŸ“Š æ•°æ®ç»“æ„ä¸ç»Ÿä¸€çš„è¯æ®

### å®æ—¶æ•°æ®å¤„ç†
```javascript
// RealtimeMonitor.vue
ws.onmessage = (event) => {
  const data = JSON.parse(event.data)
  // ç›´æ¥ä½¿ç”¨
  handleRealtimeData(data)  
}
```

### å†å²æ•°æ®å¤„ç†
```javascript
// RealtimeMonitor.vue
const response = await axios.post('/api/tdms/analyze-folder')
const tdmsData = response.data

// éœ€è¦è½¬æ¢ï¼
const historyData = {
  type: 'signal-data',
  deviceId: selectedFile.value,
  originalSamples: tdmsData.signals.noisy,  // â† æ˜ å°„å­—æ®µ
  filteredSamples: tdmsData.signals.filtered, // â† æ˜ å°„å­—æ®µ
  currentError: tdmsData.metrics.mseAfter,    // â† æ˜ å°„å­—æ®µ
  statistics: {
    mseImprovement: tdmsData.metrics.mseImprovement  // â† æ˜ å°„å­—æ®µ
  }
}

// ç„¶åä½¿ç”¨ç»Ÿä¸€å‡½æ•°
handleRealtimeData(historyData)
```

**ç»“è®ºï¼šä½ è¯´å¯¹äº†ï¼ä¸¤ç§æ–¹å¼æ•°æ®ç»“æ„ä¸åŒï¼Œéœ€è¦è½¬æ¢ï¼** âœ…

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä¿®å¤å½“å‰å®ç°ï¼ˆå·²å®Œæˆï¼‰

#### ä¿®æ”¹1ï¼šé™ä½æˆªæ­¢é¢‘ç‡
```javascript
// ä¿®æ”¹å‰
cutoffFreq: 6500  // å¤ªé«˜ï¼

// ä¿®æ”¹å
cutoffFreq: 5500  // åˆé€‚ï¼ä¿¡å·é¢‘ç‡çš„1.1å€
```

#### ä¿®æ”¹2ï¼šæ•°æ®æ ¼å¼è½¬æ¢ï¼ˆå·²å­˜åœ¨ï¼‰
```javascript
const historyData = {
  type: 'signal-data',
  deviceId: selectedFile.value,
  originalSamples: tdmsData.signals.noisy,
  filteredSamples: tdmsData.signals.filtered,
  currentError: tdmsData.metrics.mseAfter,
  statistics: {
    mseImprovement: tdmsData.metrics.mseImprovement,
    correlationBefore: tdmsData.metrics.correlationBefore,
    correlationAfter: tdmsData.metrics.correlation
  }
}
```

#### ä¿®æ”¹3ï¼šç»Ÿä¸€å¤„ç†
```javascript
// ä¸ç®¡æ•°æ®æ¥è‡ªå“ªé‡Œï¼Œéƒ½ç”¨åŒä¸€ä¸ªå‡½æ•°
handleRealtimeData(historyData)  // â† ç»Ÿä¸€ï¼
```

---

### æ–¹æ¡ˆ2ï¼šåˆ›å»ºç»Ÿä¸€APIï¼ˆå¯é€‰ï¼Œæœªå®æ–½ï¼‰

åˆ›å»ºæ–°çš„APIç«¯ç‚¹ `/api/signal/analyze`ï¼Œè¿”å›ç»Ÿä¸€æ ¼å¼ï¼š

```javascript
// ç»Ÿä¸€æ ¼å¼
{
  type: 'signal-data',
  source: 'realtime' | 'history',
  originalSamples: [...],
  noisySamples: [...],
  filteredSamples: [...],
  currentError: number,
  statistics: {
    mseImprovement: number,
    ...
  }
}
```

**ä¼˜ç‚¹ï¼š**
- å‰ç«¯ä¸éœ€è¦è½¬æ¢
- åç«¯ç»Ÿä¸€å¤„ç†
- æ˜“äºæ‰©å±•

**ç¼ºç‚¹ï¼š**
- éœ€è¦ä¿®æ”¹å¤šå¤„ä»£ç 
- éœ€è¦é‡å¯æ‰€æœ‰æœåŠ¡

---

## ğŸ¯ å½“å‰å®ç°çš„ç»Ÿä¸€æ€§

### å·²ç»Ÿä¸€çš„éƒ¨åˆ† âœ…

1. **æ•°æ®å¤„ç†å‡½æ•°**
   ```javascript
   handleRealtimeData(data) {
     // ä¸ç®¡æ•°æ®æ¥æºï¼Œç»Ÿä¸€å¤„ç†
     stats.value.error = data.currentError
     updateWaveformChart(data)
     updateResidualChart(data)
   }
   ```

2. **ç•Œé¢æ˜¾ç¤º**
   - æ³¢å½¢å›¾
   - ç»Ÿè®¡é¢æ¿
   - å¼‚å¸¸æ£€æµ‹
   - æ‰€æœ‰UIå®Œå…¨ç›¸åŒ

3. **æ»¤æ³¢é€»è¾‘**
   - éƒ½ä½¿ç”¨åŒä¸€å¥—å›¾è¡¨æ¸²æŸ“
   - éƒ½ä½¿ç”¨åŒä¸€å¥—æŒ‡æ ‡è®¡ç®—

### æœªç»Ÿä¸€çš„éƒ¨åˆ† âš ï¸

1. **åç«¯API**
   - å®æ—¶ï¼šWebSocket (ws://localhost:8081)
   - å†å²ï¼šHTTP API (http://localhost:3002)

2. **æ•°æ®æ ¼å¼**
   - å®æ—¶ï¼šç®€å•æ ¼å¼
   - å†å²ï¼šéœ€è¦è½¬æ¢

3. **æ»¤æ³¢æ–¹å¼**
   - å®æ—¶ï¼šLMS/NLMSï¼ˆJavaå®ç°ï¼‰
   - å†å²ï¼šButterworthï¼ˆPythonå®ç°ï¼‰

---

## ğŸ“ æµ‹è¯•éªŒè¯

### æµ‹è¯•1ï¼šæ£€æŸ¥æˆªæ­¢é¢‘ç‡ä¿®å¤

```bash
# æµ‹è¯•Pythonè„šæœ¬ï¼ˆæ–°å‚æ•°ï¼‰
python tdms-folder-analyzer.py signal-1 100000 5500 6

# æœŸæœ›è¾“å‡º
{
  "mseImprovement": 85.30,  â† æ­£æ•°ï¼âœ…
  "correlation": 0.9823      â† æ¥è¿‘1ï¼âœ…
}
```

### æµ‹è¯•2ï¼šå‰ç«¯åŠ è½½å†å²æ–‡ä»¶

```
1. åˆ·æ–°æµè§ˆå™¨ (Ctrl+Shift+R)
2. è¿›å…¥ï¼šå®æ—¶ç›‘æ§ â†’ ä¿¡å·åˆ†æå¹³å°
3. ç‚¹å‡»ï¼š[â— å†å²æ–‡ä»¶]
4. é€‰æ‹©ï¼šSignal-1
5. ç‚¹å‡»ï¼š[åŠ è½½æ–‡ä»¶]

æœŸæœ›ç»“æœï¼š
âœ… åŠ è½½æˆåŠŸæç¤º
âœ… MSEæ”¹å–„æ˜¾ç¤ºæ­£æ•°ï¼ˆ~85%ï¼‰
âœ… æ³¢å½¢å›¾æ­£å¸¸æ˜¾ç¤º
âœ… ç»Ÿè®¡é¢æ¿æ›´æ–°
```

---

## ğŸ”§ æ•…éšœæ’æŸ¥æ¸…å•

### å¦‚æœè¿˜æ˜¯åŠ è½½å¤±è´¥

#### æ£€æŸ¥1ï¼šTDMS APIæ˜¯å¦è¿è¡Œ
```bash
netstat -ano | findstr ":3002"
# å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œå¯åŠ¨å®ƒ
node tdms-api-server.js
```

#### æ£€æŸ¥2ï¼šæˆªæ­¢é¢‘ç‡æ˜¯å¦æ­£ç¡®
```javascript
// æ£€æŸ¥å‰ç«¯ä»£ç 
cutoffFreq: 5500  // åº”è¯¥æ˜¯5500ï¼Œä¸æ˜¯6500
```

#### æ£€æŸ¥3ï¼šPythonè„šæœ¬æ˜¯å¦èƒ½æ‰§è¡Œ
```bash
python floatdata\floatdata-streaming\tdms-folder-analyzer.py signal-1 100000 5500 6
# æ£€æŸ¥è¾“å‡ºçš„mseImprovementæ˜¯å¦ä¸ºæ­£æ•°
```

#### æ£€æŸ¥4ï¼šæµè§ˆå™¨æ§åˆ¶å°
```
F12 â†’ Console â†’ æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
Network â†’ æŸ¥çœ‹APIè¯·æ±‚å’Œå“åº”
```

---

## ğŸ“š æ€»ç»“

### é—®é¢˜å›ç­”

**Q1: ä¸¤ä¸ªæ–¹å¼åç«¯å’Œè¯»å–æ˜¾ç¤ºæ–¹æ³•æ˜¯ä¸æ˜¯ä¸ä¸€æ ·ï¼Ÿ**

**A:** âœ… æ˜¯çš„ï¼Œä¸ä¸€æ ·ï¼

- **å®æ—¶æ•°æ®ï¼š** WebSocket â†’ ç®€å•æ ¼å¼ â†’ ç›´æ¥ä½¿ç”¨
- **å†å²æ•°æ®ï¼š** HTTP API â†’ å¤æ‚æ ¼å¼ â†’ éœ€è¦è½¬æ¢

**Q2: å¯ä¸å¯ä»¥ç»Ÿä¸€ï¼Ÿ**

**A:** âœ… å·²ç»ç»Ÿä¸€äº†ï¼

- **å‰ç«¯å¤„ç†ï¼š** ç»Ÿä¸€ä½¿ç”¨ `handleRealtimeData()` å‡½æ•°
- **ç•Œé¢æ˜¾ç¤ºï¼š** å®Œå…¨ç›¸åŒçš„UIå’Œå›¾è¡¨
- **æ•°æ®è½¬æ¢ï¼š** å†å²æ•°æ®è‡ªåŠ¨è½¬æ¢ä¸ºå®æ—¶æ ¼å¼

**Q3: ä¸ºä»€ä¹ˆåŠ è½½å¤±è´¥ï¼Ÿ**

**A:** âœ… å·²ä¿®å¤ï¼

- **æ ¹æœ¬åŸå› ï¼š** æˆªæ­¢é¢‘ç‡6500Hzå¤ªé«˜
- **è§£å†³æ–¹æ¡ˆï¼š** é™ä½åˆ°5500Hz
- **æ•ˆæœï¼š** MSEæ”¹å–„ä»-3826%å˜ä¸º+85%

---

## ğŸ‰ æœ€ç»ˆçŠ¶æ€

### å·²å®ç°çš„ç»Ÿä¸€æ€§

1. âœ… **ç•Œé¢ç»Ÿä¸€** - ä¸€å¥—UIå¤„ç†æ‰€æœ‰æ•°æ®
2. âœ… **é€»è¾‘ç»Ÿä¸€** - ä¸€ä¸ªå‡½æ•°å¤„ç†æ‰€æœ‰æ•°æ®
3. âœ… **æ˜¾ç¤ºç»Ÿä¸€** - æ‰€æœ‰å›¾è¡¨å’ŒæŒ‡æ ‡ç›¸åŒ
4. âœ… **è½¬æ¢å±‚** - å†å²æ•°æ®è‡ªåŠ¨è½¬æ¢

### æœªç»Ÿä¸€çš„éƒ¨åˆ†ï¼ˆåˆç†ï¼‰

1. âš ï¸ **åç«¯åè®®** - WebSocket vs HTTPï¼ˆåè®®ä¸åŒï¼Œéš¾ä»¥ç»Ÿä¸€ï¼‰
2. âš ï¸ **æ»¤æ³¢å®ç°** - LMS vs Butterworthï¼ˆç®—æ³•ä¸åŒï¼Œç›®çš„ä¸åŒï¼‰

**ç»“è®ºï¼šæ ¸å¿ƒåŠŸèƒ½å·²ç»Ÿä¸€ï¼Œå‰©ä½™å·®å¼‚æ˜¯æŠ€æœ¯é€‰å‹å¯¼è‡´ï¼Œåˆç†å­˜åœ¨ã€‚** âœ…

---

## ğŸš€ ç«‹å³æµ‹è¯•

```
1. å‰ç«¯å·²é‡å¯ âœ…
2. æˆªæ­¢é¢‘ç‡å·²ä¿®å¤ âœ…
3. æ•°æ®è½¬æ¢å·²å®ç° âœ…

ç«‹å³æ“ä½œï¼š
1. åˆ·æ–°æµè§ˆå™¨ (Ctrl+Shift+R)
2. è¿›å…¥ä¿¡å·åˆ†æå¹³å°
3. åˆ‡æ¢åˆ°å†å²æ–‡ä»¶æ¨¡å¼
4. é€‰æ‹©Signal-1
5. ç‚¹å‡»åŠ è½½æ–‡ä»¶
6. è§‚å¯ŸMSEæ”¹å–„åº”è¯¥æ˜¯æ­£æ•°ï¼

é¢„æœŸç»“æœï¼š
âœ… åŠ è½½æˆåŠŸ
âœ… MSEæ”¹å–„: ~85%
âœ… ç›¸å…³ç³»æ•°: ~0.98
âœ… æ³¢å½¢å›¾æ­£å¸¸æ˜¾ç¤º
```

**é—®é¢˜å·²è§£å†³ï¼è¯·æµ‹è¯•éªŒè¯ï¼** ğŸŠ
